<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Quality - عالم الأناقة الفاخرة</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Almarai:wght@400;700&family=Cinzel+Decorative:wght@700&family=Great+Vibes&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <style>
        /* --- Base & Variables --- */
        :root {
            --bg-color: #0a0a0a; --bg-gradient: linear-gradient(180deg, #1f1f1f 0%, #0a0a0a 100%);
            --card-bg: #1c1c1c; --primary-gold: #e0c070; --dark-gold: #b8860b;
            --light-gold-text: #f8f0d8; --white-text: #f5f5f5; --grey-text: #b5b5b5;
            --shadow-dark: rgba(0, 0, 0, 0.75); --glow-gold: rgba(224, 192, 112, 0.4);
            --available-green: #5cb85c; --new-blue: #4a90e2; --error-red: #e74c3c;
            --scroll-behavior: smooth; --transition-main: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            --transition-smooth: 0.4s ease; --card-min-width-lg: 300px; --card-gap-lg: 40px;
            --card-min-width-md: 270px; --card-gap-md: 30px; --card-min-width-sm: 230px;
            --card-gap-sm: 25px; --card-min-width-xs: 100%; --card-gap-xs: 25px; /* Single Column */
            --image-max-height: 360px; --header-height: 70px; --bottom-nav-height: 70px; /* Increased height */
            --main-font: 'Tajawal', sans-serif;
        }
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: var(--scroll-behavior); scroll-padding-top: calc(var(--header-height) + 10px); /* Offset for sticky header */}
        body {
            font-family: var(--main-font); background: var(--bg-color); background-image: var(--bg-gradient);
            color: var(--white-text); line-height: 1.7; overflow-x: hidden;
            padding-bottom: var(--bottom-nav-height); font-weight: 400;
            -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
        }
        .container { max-width: 1800px; margin: 0 auto; padding: 0 40px; }

        /* --- Header --- */
        header { position: sticky; top: 0; z-index: 1000; background-color: rgba(5, 5, 5, 0.9); backdrop-filter: blur(20px); padding: 10px 0; box-shadow: 0 6px 25px var(--shadow-dark); border-bottom: 1px solid var(--dark-gold); height: var(--header-height); }
        .header-content { display: flex; justify-content: space-between; align-items: center; height: 100%; max-width: 1800px; margin: 0 auto; padding: 0 40px; }
        .logo img { max-height: 55px; transition: var(--transition-smooth); filter: brightness(1.1); }
        .logo img:hover { transform: scale(1.08) rotate(-2deg); filter: drop-shadow(0 0 15px var(--glow-gold)) brightness(1.2); }
        nav.desktop-nav ul { list-style: none; display: flex; gap: 35px; }
        nav.desktop-nav ul li a { color: var(--grey-text); text-decoration: none; font-weight: 500; font-size: 1.05rem; transition: color 0.3s ease, text-shadow 0.3s ease; padding-bottom: 6px; border-bottom: 2px solid transparent; position: relative; cursor: pointer; letter-spacing: 0.5px; }
        nav.desktop-nav ul li a::after { content: ''; position: absolute; width: 0; height: 2px; bottom: -2px; right: 0; background-color: var(--primary-gold); transition: width 0.4s ease; }
        nav.desktop-nav ul li a:hover, nav.desktop-nav ul li a.active { color: var(--primary-gold); text-shadow: 0 0 6px var(--glow-gold); }
        nav.desktop-nav ul li a:hover::after, nav.desktop-nav ul li a.active::after { width: 100%; left: 0; right: auto; }
        .controls-area { display: flex; align-items: center; gap: 15px; flex-wrap: nowrap; }
        .filter-control select, #search-input { padding: 10px 16px; border-radius: 8px; border: 1px solid #444; background-color: #222; color: var(--white-text); font-family: var(--main-font); font-size: 0.9rem; transition: all var(--transition-smooth); }
        .filter-control select { padding-left: 35px; cursor: pointer; appearance: none; -webkit-appearance: none; -moz-appearance: none; background-image: url('data:image/svg+xml;utf8,<svg fill="%23dcb97a" height="20" viewBox="0 0 24 24" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>'); background-repeat: no-repeat; background-position: left 10px center; min-width: 130px; }
        .filter-control select:hover, #search-input:hover { border-color: var(--primary-gold); }
        .filter-control select:focus, #search-input:focus { outline: none; border-color: var(--primary-gold); background-color: #2a2a2a; box-shadow: 0 0 10px var(--glow-gold); }
        .search-container { position: relative; }
        #search-input { width: 200px; padding-right: 40px; } #search-input:focus { width: 250px; }
        #search-input::placeholder { color: var(--grey-text); opacity: 0.6; }
        .search-container .search-icon { position: absolute; right: 16px; top: 50%; transform: translateY(-50%); color: var(--grey-text); pointer-events: none; transition: color 0.3s ease; font-size: 1rem; }
        #search-input:focus + .search-icon { color: var(--primary-gold); }
        .mobile-controls { display: none; gap: 20px; }
        .mobile-control-btn { background: none; border: none; color: var(--grey-text); font-size: 1.5rem; cursor: pointer; transition: color var(--transition-smooth); padding: 5px; }
        .mobile-control-btn:hover { color: var(--primary-gold); }

        /* --- Hero Section --- */
        .hero-section { min-height: 70vh; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.9)), url('') no-repeat center center / cover; background-color: #050505; padding: 80px 20px; position: relative; overflow: hidden; border-bottom: 1px solid #333; }
        .hero-content { z-index: 2; max-width: 850px; animation: fadeInHero 1.8s ease-out; }
        .hero-title { font-family: 'Great Vibes', cursive; font-size: 6rem; color: var(--primary-gold); margin-bottom: 5px; line-height: 1; text-shadow: 0 0 30px var(--glow-gold), 0 0 50px var(--glow-gold); }
        .hero-subtitle { font-family: 'Cinzel Decorative', serif; font-size: 1.7rem; color: var(--light-gold-text); margin-bottom: 40px; letter-spacing: 2.5px; opacity: 0.9; }
        .hero-cta-button { display: inline-block; background: linear-gradient(145deg, var(--primary-gold), var(--dark-gold)); color: #111; padding: 16px 45px; border: none; border-radius: 50px; text-decoration: none; font-weight: 700; font-size: 1.15rem; font-family: var(--main-font); cursor: pointer; transition: all var(--transition-smooth); box-shadow: 0 10px 25px rgba(0, 0, 0, 0.6); letter-spacing: 1px; }
        .hero-cta-button:hover { background: linear-gradient(145deg, var(--dark-gold), var(--primary-gold)); color: var(--white-text); box-shadow: 0 14px 30px rgba(0, 0, 0, 0.7), 0 0 35px var(--glow-gold); transform: scale(1.05) translateY(-3px); }
        @keyframes fadeInHero { from { opacity: 0; transform: translateY(40px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Main Content --- */
        main { padding: 60px 0; }
        .category-section-header { text-align: center; margin-bottom: 45px; padding-bottom: 18px; border-bottom: 1px solid #333; }
        .category-section-header.active { animation: fadeInHero 0.8s ease-out; }
        .category-section-header h2 { font-family: 'Cinzel Decorative', serif; font-size: 2.6rem; font-weight: 700; color: var(--primary-gold); text-shadow: 0 0 18px var(--glow-gold); letter-spacing: 1.5px; transition: opacity 0.5s ease; }

        /* Product Grid */
        .product-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(var(--card-min-width-lg), 1fr)); gap: var(--card-gap-lg); perspective: 1800px; position: relative; }
        .product-card {
            background: var(--card-bg); border-radius: 16px; overflow: hidden;
            box-shadow: 0 12px 35px var(--shadow-medium), inset 0 0 5px rgba(0,0,0,0.4);
            transition: transform var(--transition-smooth), box-shadow var(--transition-smooth); /* Smoother transition */
            transform-style: preserve-3d; border: 1px solid #3a3a3a;
            display: flex; flex-direction: column; position: relative; cursor: pointer;
            opacity: 0; transform: translateY(60px);
            animation: fadeInUpCard 0.8s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
            animation-delay: calc(var(--card-index) * 0.07s);
        }
        .product-card.hidden { display: none !important; }
        .product-card:hover {
            transform: translateY(-15px) translateZ(65px) rotateY(7deg) rotateX(2deg) scale(1.02); /* Refined hover */
            box-shadow: 0 22px 48px var(--shadow-dark), 0 0 40px var(--glow-gold), inset 0 0 8px rgba(0,0,0,0.2);
        }
        .product-image-container { width: 100%; overflow: hidden; background-color: #222; position: relative; transform-style: preserve-3d; border-bottom: 1px solid var(--dark-gold); padding: 12px; border-radius: 16px 16px 0 0; display: flex; justify-content: center; align-items: center; min-height: 260px; }
        .product-card img { display: block; width: auto; height: auto; max-width: 100%; max-height: var(--image-max-height); object-fit: contain; border-radius: 8px; transition: transform 0.5s cubic-bezier(0.165, 0.84, 0.44, 1), filter 0.4s ease; transform: translateZ(30px) scale(1.0); box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
        .product-card:hover img { transform: translateZ(50px) scale(1.08) rotateY(-3deg); filter: brightness(1.12); }
        .badges { position: absolute; top: 18px; left: 18px; display: flex; flex-direction: column; gap: 7px; z-index: 3; pointer-events: none; }
        .badge { color: var(--white-text); font-size: 0.7rem; font-weight: 500; padding: 3px 9px; border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.5); text-align: center; opacity: 0.9; display: flex; align-items: center; gap: 4px; background-color: rgba(15, 15, 15, 0.65); backdrop-filter: blur(5px); border: 1px solid rgba(255,255,255,0.1);}
        .badge i { font-size: 0.65rem; opacity: 0.8; }
        .badge.available { border-color: rgba(92, 184, 92, 0.5); color: var(--available-green);} .badge.available i {color: var(--available-green);}
        .badge.new-arrival { border-color: rgba(74, 144, 226, 0.5); color: var(--new-blue);} .badge.new-arrival i {color: var(--new-blue);}

        .product-info { padding: 20px 25px 25px 25px; text-align: center; flex-grow: 1; display: flex; flex-direction: column; justify-content: flex-start; /* Align content top */ transform: translateZ(20px); transition: transform var(--transition-smooth); background: var(--card-bg); border-radius: 0 0 16px 16px;}
        .product-card:hover .product-info { transform: translateZ(40px); }
        .product-card h3 { font-family: var(--main-font); font-size: 1.1rem; font-weight: 700; color: var(--primary-gold); margin-bottom: 10px; line-height: 1.45; min-height: 48px; text-shadow: none; }
        .product-card .price-card { font-size: 1.2rem; font-weight: 500; color: var(--white-text); margin-bottom: 15px; letter-spacing: 0.5px; }
        .product-card .price-card i { color: var(--dark-gold); margin-left: 4px; font-size: 1rem;}
        .product-card .price-card .currency { font-size: 0.8rem; font-weight: 400; color: var(--grey-text); margin-right: 3px; }
        /* No direct button, card is clickable */

        /* --- Features Section --- */
        .features-section { padding: 80px 0 90px 0; margin-top: 60px; background: #101010; border-top: 1px solid #333; border-bottom: 1px solid #333; position: relative; perspective: 1500px; overflow: hidden; }
         .features-section::before { /* Subtle texture/overlay */
             content: ''; position: absolute; top:0; left: 0; width: 100%; height: 100%;
             /* background: url('...') repeat; opacity: 0.03; */
             pointer-events: none;
         }
        .features-title { font-family: 'Cinzel Decorative', serif; font-size: 2.6rem; font-weight: 700; color: var(--primary-gold); text-align: center; margin-bottom: 60px; text-shadow: 0 0 18px var(--glow-gold); letter-spacing: 1.5px; }
        .features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 40px; max-width: 1200px; margin: 0 auto; }
        .feature-item { background-color: rgba(35, 35, 35, 0.5); /* Darker feature bg */ padding: 40px 30px; border-radius: 12px; text-align: center; border: 1px solid #444; box-shadow: 0 8px 25px rgba(0,0,0,0.5); transform-style: preserve-3d; transition: transform var(--transition-smooth), box-shadow var(--transition-smooth); }
        .feature-item:hover { transform: translateY(-10px) scale(1.03) rotateX(3deg); box-shadow: 0 15px 35px var(--shadow-dark), 0 0 20px var(--glow-gold); }
        .feature-item i { font-size: 3.2rem; color: var(--primary-gold); margin-bottom: 22px; display: block; text-shadow: 0 0 15px var(--glow-gold); transform: translateZ(30px); }
        .feature-item h3 { font-size: 1.3rem; color: var(--light-gold-text); margin-bottom: 12px; font-weight: 700; transform: translateZ(20px); }
        .feature-item p { font-size: 0.95rem; color: var(--grey-text); line-height: 1.8; transform: translateZ(10px); }

        /* --- Modals --- */
         /* Modal Overlay */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--modal-bg); backdrop-filter: blur(12px); display: flex; justify-content: center; align-items: center; opacity: 0; visibility: hidden; transition: opacity 0.4s ease, visibility 0s linear 0.4s; z-index: 2000; padding: 15px; }
        .modal-overlay.active { opacity: 1; visibility: visible; transition-delay: 0s; }
        /* Modal Content Base */
        .modal-content { background: linear-gradient(145deg, #2a2a2a, #1f1f1f); color: var(--white-text); padding: 25px 35px; border-radius: 18px; position: relative; max-width: 950px; width: 95%; max-height: 90vh; overflow-y: auto; border: 1px solid var(--dark-gold); box-shadow: 0 20px 60px var(--shadow-dark); transform: scale(0.9) translateY(-20px); transition: transform 0.4s cubic-bezier(0.165, 0.84, 0.44, 1); }
        .modal-overlay.active .modal-content { transform: scale(1) translateY(0); }
        .modal-close { position: absolute; top: 15px; left: 20px; background: none; border: none; color: var(--grey-text); font-size: 2.2rem; cursor: pointer; transition: color 0.3s ease, transform 0.3s ease; line-height: 1; z-index: 10;}
        .modal-close:hover { color: var(--primary-gold); transform: rotate(180deg) scale(1.1); }
         /* Quick View Modal */
        #quick-view-modal .modal-body { display: flex; gap: 30px; flex-wrap: wrap; }
        #quick-view-modal .modal-image { flex: 1 1 320px; min-width: 280px; cursor: zoom-in; border-radius: 15px; overflow: hidden; background-color: #282828; padding: 10px;}
        #quick-view-modal .modal-image img { display: block; width: 100%; height: auto; max-height: 450px; object-fit: contain; border-radius: 10px; transition: transform 0.3s ease; }
        #quick-view-modal .modal-image:hover img { transform: scale(1.25); }
        #quick-view-modal .modal-details { flex: 1 1 400px; min-width: 300px; }
        #quick-view-modal .modal-details h2 { font-family: var(--main-font); font-size: 2rem; font-weight: 700; color: var(--primary-gold); margin-bottom: 20px; border-bottom: 1px solid var(--dark-gold); padding-bottom: 12px; text-shadow: 0 0 8px var(--glow-gold); }
        #quick-view-modal .info-item { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; justify-content: flex-start; }
        #quick-view-modal .info-item i { color: var(--dark-gold); font-size: 1.2rem; width: 22px; text-align: center; }
        #quick-view-modal .info-item .label { font-size: 0.95rem; color: var(--grey-text); font-weight: 300;} /* Lighter label */
        #quick-view-modal .info-item .value { font-size: 1.1rem; color: var(--white-text); font-weight: 700; }
        #quick-view-modal .info-item .currency { font-size: 0.9rem; margin-right: 3px; }
        #quick-view-modal .description { color: var(--grey-text); margin: 20px 0 30px 0; font-size: 0.95rem; /* Slightly smaller desc */ line-height: 1.8; }
        #proceed-button { display: block; width: 100%; text-align: center; background: linear-gradient(145deg, var(--primary-gold), var(--dark-gold)); color: #111; padding: 15px 35px; border: none; border-radius: 12px; text-decoration: none; font-weight: 700; font-size: 1.05rem; font-family: var(--main-font); cursor: pointer; transition: all var(--transition-smooth); box-shadow: 0 7px 15px rgba(0, 0, 0, 0.6); letter-spacing: 0.8px; margin-top: 20px; }
        #proceed-button i { margin-left: 10px; }
        #proceed-button:hover { background: linear-gradient(145deg, var(--dark-gold), var(--primary-gold)); color: var(--white-text); box-shadow: 0 10px 20px rgba(0, 0, 0, 0.7), 0 0 25px var(--glow-gold); transform: scale(1.03); }
         /* Order Form Modal */
        #order-form-modal .modal-content { max-width: 650px; border-color: var(--available-green); }
        #order-form-modal .modal-header { text-align: center; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px solid var(--dark-gold);}
        #order-form-modal .modal-header i { font-size: 2.8rem; color: var(--primary-gold); margin-bottom: 12px; display: block; text-shadow: 0 0 15px var(--glow-gold);}
        #order-form-modal .modal-header h2 { font-family: 'Cinzel Decorative', serif; font-size: 1.8rem; color: var(--primary-gold); margin-bottom: 8px; letter-spacing: 1px;}
        #order-form-modal .modal-header p { font-size: 1rem; color: var(--grey-text); }
        .order-summary { background-color: rgba(0,0,0,0.2); padding: 18px; margin-bottom: 25px; border-radius: 12px; border: 1px solid #333; text-align: center; box-shadow: inset 0 0 8px rgba(0,0,0,0.3); }
        .order-summary h4 { color: var(--light-gold-text); margin-bottom: 12px; font-size: 1.1rem; font-weight: 700; border-bottom: 1px dashed var(--dark-gold); padding-bottom: 10px; letter-spacing: 0.5px; }
        .order-summary p { font-size: 0.95rem; color: var(--white-text); margin-bottom: 8px; }
        .order-summary span { font-weight: bold; color: var(--primary-gold); } .order-summary .currency { font-size: 0.85rem; }
        #order-form label { display: block; margin-bottom: 6px; font-weight: 500; /* Medium weight */ color: var(--light-gold-text); font-size: 0.95rem; text-align: right; }
        #order-form input[type="text"], #order-form input[type="tel"], #order-form textarea { width: 100%; padding: 12px 15px; margin-bottom: 18px; border-radius: 8px; border: 1px solid #444; background-color: #282828; color: var(--white-text); font-family: var(--main-font); font-size: 0.95rem; transition: border-color 0.3s, box-shadow 0.3s; box-shadow: inset 0 1px 3px rgba(0,0,0,0.4); }
        #order-form input[type="text"]:focus, #order-form input[type="tel"]:focus, #order-form textarea:focus { outline: none; border-color: var(--primary-gold); box-shadow: 0 0 10px var(--shadow-light), inset 0 1px 3px rgba(0,0,0,0.2); }
        #order-form textarea { min-height: 90px; resize: vertical; }
        #form-error-message { color: var(--error-red); background-color: rgba(231, 76, 60, 0.1); border: 1px solid var(--error-red); font-size: 0.9rem; margin-top: -10px; margin-bottom: 15px; display: none; text-align: center; font-weight: bold; padding: 10px; border-radius: 8px; }
        #modal-whatsapp-button-final { display: block; background: linear-gradient(145deg, var(--available-green), #388E3C); color: white; padding: 16px 35px; border: none; border-radius: 12px; text-decoration: none; font-weight: 700; font-size: 1.1rem; font-family: var(--main-font); cursor: pointer; transition: all 0.4s ease; box-shadow: 0 8px 18px rgba(0, 0, 0, 0.7); letter-spacing: 1px; margin-top: 25px; width: 100%; text-align: center; text-shadow: 1px 1px 3px rgba(0,0,0,0.4); }
        #modal-whatsapp-button-final i { margin-left: 10px; }
        #modal-whatsapp-button-final:hover { background: linear-gradient(145deg, #388E3C, #5cb860); box-shadow: 0 12px 25px rgba(0, 0, 0, 0.8), 0 0 25px rgba(76, 175, 80, 0.5); transform: scale(1.03) translateY(-2px); }

        /* --- Footer --- */
        footer { text-align: center; margin-top: 80px; padding: 50px 20px; background: #050505; color: var(--grey-text); font-size: 1rem; border-top: 2px solid var(--dark-gold); box-shadow: 0 -10px 30px rgba(0,0,0,0.6); }
        footer p { margin-bottom: 10px; font-weight: 300; }
        footer a { color: var(--primary-gold); text-decoration: none; font-weight: 500; transition: color 0.3s ease, text-shadow 0.3s ease; }
        footer a:hover { color: var(--white-text); text-shadow: 0 0 10px var(--glow-gold); }
        footer a i { margin-left: 5px; }

        /* --- Animations --- */
        @keyframes fadeInUpCard { from { opacity: 0; transform: translateY(60px); } to { opacity: 1; transform: translateY(0); } }

        /* --- No Results --- */
        #no-results { text-align: center; font-size: 1.5rem; color: var(--grey-text); display: none; margin: 80px 0; padding: 40px; background-color: var(--card-bg); border-radius: 15px; border: 1px solid var(--dark-gold); box-shadow: 0 5px 20px var(--shadow-dark); }
        #no-results i { color: var(--primary-gold); margin-left: 15px; font-size: 1.8rem; }

        /* --- Bottom Navigation (Mobile Only) - Enhanced Styling --- */
        .bottom-nav { display: none; position: fixed; bottom: 0; left: 0; width: 100%; height: var(--bottom-nav-height); background-color: rgba(10, 10, 10, 0.97); backdrop-filter: blur(20px); box-shadow: 0 -7px 28px var(--shadow-dark); border-top: 1px solid #333; z-index: 1001; }
        .bottom-nav ul { list-style: none; display: flex; justify-content: space-around; align-items: stretch; height: 100%; padding: 0 5px; }
        .bottom-nav ul li { flex: 1; text-align: center; display: flex; }
        .bottom-nav ul li a { display: flex; flex-direction: column; align-items: center; justify-content: center; flex-grow: 1; color: var(--grey-text); text-decoration: none; font-size: 0.8rem; font-weight: 500; padding: 6px 0; transition: color 0.3s ease, transform 0.3s ease; position: relative; }
        .bottom-nav ul li a i { font-size: 1.7rem; margin-bottom: 4px; display: block; transition: transform 0.3s ease; }
        .bottom-nav ul li a:hover { color: var(--light-gold-text); }
        .bottom-nav ul li a.active { color: var(--primary-gold); }
        .bottom-nav ul li a.active i { transform: scale(1.15) translateY(-3px); color: var(--primary-gold); /* Make icon gold too */}
        .bottom-nav ul li a::before { content: ''; position: absolute; bottom: 5px; left: 50%; transform: translateX(-50%); width: 0; height: 3px; background-color: var(--primary-gold); border-radius: 2px; transition: width 0.4s ease; }
        .bottom-nav ul li a.active::before { width: 40%; }

        /* --- Filter/Search Overlays (Mobile Only - Styling remains same) --- */
        .mobile-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.85); backdrop-filter: blur(10px); z-index: 1500; display: flex; justify-content: center; align-items: flex-start; padding-top: calc(var(--header-height) + 15px); opacity: 0; visibility: hidden; transition: opacity 0.4s ease, visibility 0s linear 0.4s; }
        .mobile-overlay.active { opacity: 1; visibility: visible; transition-delay: 0s; }
        .mobile-overlay-content { background-color: #1f1f1f; padding: 30px 25px; border-radius: 15px; box-shadow: 0 10px 30px var(--shadow-dark); width: 90%; max-width: 450px; transform: translateY(-40px); transition: transform 0.4s ease; border: 1px solid var(--dark-gold); position: relative; }
        .mobile-overlay.active .mobile-overlay-content { transform: translateY(0); }
        .mobile-overlay-close { position: absolute; top: 10px; left: 15px; background: none; border: none; color: var(--grey-text); font-size: 1.8rem; cursor: pointer; transition: color 0.3s ease, transform 0.3s ease; }
        .mobile-overlay-close:hover { color: var(--primary-gold); transform: scale(1.1); }
        .mobile-overlay h3 { color: var(--primary-gold); font-size: 1.4rem; text-align: center; margin-bottom: 25px; font-family: var(--main-font); font-weight: 700; }
        .mobile-overlay .filter-control select, .mobile-overlay #search-input-mobile { width: 100%; margin-bottom: 20px; font-size: 1rem; padding: 12px 15px; padding-left: 35px; border-radius: 8px; background-color: #282828; }
        .mobile-overlay #search-input-mobile { padding-right: 45px; padding-left: 15px; }
        .mobile-overlay .search-container { width: 100%; }
        .mobile-overlay .search-container .search-icon { right: 18px; font-size: 1.1rem;}
        #apply-mobile-filters { display: block; width: 100%; text-align: center; background: linear-gradient(145deg, var(--primary-gold), var(--dark-gold)); color: #111; padding: 12px 25px; border: none; border-radius: 10px; font-weight: 700; font-size: 1rem; cursor: pointer; transition: all var(--transition-smooth); margin-top: 10px; }
        #apply-mobile-filters:hover { background: linear-gradient(145deg, var(--dark-gold), var(--primary-gold)); color: var(--white-text); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5), 0 0 15px var(--glow-gold); transform: scale(1.02);}


        /* --- Responsive --- */
          /* Combined & Refined Media Queries */
          @media (max-width: 1400px) { .container, .header-content { padding: 0 25px; } .product-grid { grid-template-columns: repeat(auto-fit, minmax(var(--card-min-width-md), 1fr)); gap: var(--card-gap-md); } }
          @media (max-width: 1200px) { .product-grid { grid-template-columns: repeat(auto-fit, minmax(var(--card-min-width-md), 1fr)); gap: var(--card-gap-md); } .category-title { font-size: 3rem; } .hero-title { font-size: 5rem;} .hero-subtitle { font-size: 1.4rem;} .features-title { font-size: 2.5rem; } }
          @media (max-width: 992px) {
             :root { --image-max-height: 300px; --card-min-width-sm: 250px;}
             .filter-control select, #search-input { font-size: 0.8rem; padding: 8px 12px; padding-left: 30px; min-width: 95px;}
             #search-input { width: 130px; padding-right: 35px;} #search-input:focus { width: 160px; }
             .controls-area { gap: 8px; }
             .product-grid { grid-template-columns: repeat(auto-fit, minmax(var(--card-min-width-sm), 1fr)); gap: var(--card-gap-sm); }
             .category-title { font-size: 2.5rem; } .category-section-header h2 { font-size: 2rem; }
             .modal-content { padding: 25px 30px; max-width: 90%;} #order-form-modal .modal-content { max-width: 600px; }
             .modal-details h2 { font-size: 1.8rem; } .modal-whatsapp-button, #proceed-button, #modal-whatsapp-button-final { font-size: 1rem; padding: 14px 30px;}
             nav.desktop-nav { display: none; } .header-content { justify-content: space-between;} .mobile-controls { display: flex; } .controls-area { display: none; }
             .hero-title { font-size: 4rem;} .hero-subtitle { font-size: 1.2rem;} .features-title { font-size: 2.2rem; } .features-grid { gap: 30px;}
         }
          @media (max-width: 768px) {
             :root { --image-max-height: 320px; --header-height: 65px; --card-min-width-sm: 47%; --card-gap-sm: 20px;}
             body { font-size: 15px; padding-bottom: var(--bottom-nav-height); } .container, .header-content { padding: 0 15px; } header { padding: 8px 0; }
             .header-content { justify-content: space-between; } .logo img { max-height: 45px; }
             nav.desktop-nav { display: none; } .controls-area { display: none; } .mobile-controls { display: flex; gap: 15px;} .mobile-control-btn { font-size: 1.3rem;}
             .bottom-nav { display: flex; } main { padding: 30px 0; }
             .product-grid { grid-template-columns: 1fr 1fr; gap: var(--card-gap-sm); } /* 2 columns */
             .category-title { font-size: 2.2rem; margin-bottom: 40px;} .category-section-header h2 { font-size: 1.8rem;}
             .product-info { padding: 18px 15px 20px 15px; transform: translateZ(20px); }
             .product-card h3 { font-size: 0.95rem; min-height: 40px; margin-bottom: 10px;} .product-card .price-card { font-size: 1.1rem; margin-bottom: 15px;}
             .badges { top: 12px; left: 12px; gap: 5px;} .badge { font-size: 0.65rem; padding: 2px 7px; border-radius: 8px; } .badge i { font-size: 0.6rem;}
             .modal-content { padding: 20px 20px; max-height: 88vh; width: 95%;}
             .modal-body { flex-direction: column; gap: 15px; } .modal-image img { max-height: 280px;}
             .modal-details h2 { font-size: 1.4rem; } .modal-details .description { font-size: 0.85rem; margin: 15px 0 25px 0; line-height: 1.7;}
             #order-form input, #order-form textarea { padding: 10px 12px; font-size: 0.9rem; margin-bottom: 15px;}
             .modal-whatsapp-button, #proceed-button, #modal-whatsapp-button-final { font-size: 0.95rem; padding: 11px 25px;}
             #order-form-modal .modal-header i { font-size: 2rem; } #order-form-modal .modal-header h2 { font-size: 1.4rem;}
             .hero-title { font-size: 3rem;} .hero-subtitle { font-size: 1rem;} .hero-cta-button { font-size: 0.95rem; padding: 12px 30px;}
             .features-section { padding: 60px 15px; } .features-title { font-size: 1.8rem; margin-bottom: 40px;} .features-grid { grid-template-columns: 1fr; gap: 30px;} /* Stack features */
         }
          @media (max-width: 500px) {
               :root { --image-max-height: 280px; --card-min-width-xs: 100%; --card-gap-xs: 20px;}
              .product-grid { grid-template-columns: 1fr; gap: var(--card-gap-xs); } /* Single column */
              .product-info { padding: 15px; }
              .product-card h3 { font-size: 1rem; } .product-card .price-card { font-size: 1.15rem; }
              .category-title { font-size: 1.8rem; } footer { padding: 30px 15px 80px 15px; font-size: 0.9rem;}
              .bottom-nav ul li a { font-size: 0.7rem;} .bottom-nav ul li a i { font-size: 1.4rem;}
              .hero-title { font-size: 2.5rem;}
              #quick-view-modal .modal-details h2 { font-size: 1.6rem;} #order-form-modal .modal-header h2 { font-size: 1.4rem;}
              .controls-area { flex-direction: column; gap: 10px; width: 95%; margin: 0 auto; }
              .filter-control select, #search-input { width: 100%; } #search-input:focus { width: 100%; }
          }

    </style>
</head>
<body>

    <header>
       <div class="header-content">
            <div class="logo">
                <a href="#" onclick="setActiveCategory('all'); return false;"><img src="logo.png" alt="Master Quality Logo"></a>
            </div>
             <nav class="desktop-nav">
                 <ul>
                     <li><a href="#category-header" data-category="all" class="nav-link active">الكل</a></li>
                     <li><a href="#category-header" data-category="trousers" class="nav-link">بناطيل</a></li>
                     <li><a href="#category-header" data-category="maternity" class="nav-link">حوامل</a></li>
                     <li><a href="#category-header" data-category="tops" class="nav-link">توبات</a></li>
                 </ul>
             </nav>
            <div class="controls-area">
                 <div class="filter-control">
                     <select id="size-select" title="فلترة حسب المقاس">
                         <option value="all">كل المقاسات</option>
                         <option value="XS">XS</option> <option value="S">S</option> <option value="M">M</option>
                         <option value="L">L</option> <option value="XL">XL</option> <option value="XXL">XXL</option>
                         <option value="2XL">2XL</option>
                     </select>
                 </div>
                <div class="search-container">
                    <input type="search" id="search-input" placeholder="بحث بالاسم...">
                    <i class="fas fa-search search-icon"></i>
                </div>
            </div>
             <div class="mobile-controls">
                 <button class="mobile-control-btn" id="mobile-filter-btn" aria-label="فلترة"><i class="fas fa-filter"></i></button>
                 <button class="mobile-control-btn" id="mobile-search-btn" aria-label="بحث"><i class="fas fa-search"></i></button>
             </div>
        </div>
    </header>

     <div id="mobile-search-overlay" class="mobile-overlay">
        <div class="mobile-overlay-content">
            <button class="mobile-overlay-close" id="close-search-overlay">&times;</button>
            <h3><i class="fas fa-search"></i> البحث عن منتج</h3>
            <div class="search-container"> <input type="search" id="search-input-mobile" placeholder="ادخل اسم المنتج..."><i class="fas fa-search search-icon"></i> </div>
        </div>
    </div>
     <div id="mobile-filter-overlay" class="mobile-overlay">
         <div class="mobile-overlay-content">
            <button class="mobile-overlay-close" id="close-filter-overlay">&times;</button>
            <h3><i class="fas fa-filter"></i> فلترة حسب المقاس</h3>
             <div class="filter-control">
                 <select id="size-select-mobile">
                     <option value="all">كل المقاسات</option> <option value="XS">XS</option> <option value="S">S</option> <option value="M">M</option> <option value="L">L</option> <option value="XL">XL</option> <option value="XXL">XXL</option> <option value="2XL">2XL</option>
                 </select>
             </div>
             <button class="details-button" style="width:100%; margin-top: 15px;" id="apply-mobile-filters">تطبيق الفلتر</button>
        </div>
    </div>

    <section class="hero-section">
        <div class="hero-content">
             <h1 class="hero-title">Master Quality</h1>
             <p class="hero-subtitle">تجربة تسوق ترتقي لمعايير الجودة والأناقة</p>
             <a href="#category-header" class="hero-cta-button" onclick="setActiveCategory('all'); return false;"> <i class="fas fa-tshirt"></i> استكشف التشكيلة الآن</a>
        </div>
    </section>


    <main class="container">
        <div id="category-header" class="category-section-header">
            <h2 id="category-title-main">جميع المنتجات</h2>
        </div>

        <div class="product-grid" id="product-grid-main">
            </div>
        <div id="no-results">
            <i class="fas fa-heart-crack"></i> لا توجد منتجات تطابق المعايير المختارة. حاول تغيير الفلتر أو البحث!
        </div>

         <section class="features-section">
            <h2 class="features-title">لماذا Master Quality؟</h2>
            <div class="features-grid">
                <div class="feature-item">
                    <i class="fas fa-shipping-fast"></i>
                    <h3>توصيل سريع</h3>
                    <p>نصلكِ أينما كنتِ في بغداد وجميع المحافظات بأسرع وقت ممكن.</p>
                </div>
                <div class="feature-item">
                    <i class="fas fa-gem"></i>
                    <h3>جودة لا تضاهى</h3>
                    <p>ننتقي أجود الخامات والتصاميم العصرية لنضمن لكِ التميز.</p>
                </div>
                <div class="feature-item">
                    <i class="fas fa-shield-alt"></i>
                    <h3>ضمان ورضا</h3>
                    <p>نسعى دائمًا لرضاكِ التام عن كل قطعة تختارينها من تشكيلتنا.</p>
                </div>
            </div>
        </section>

    </main>

    <div id="quick-view-modal" class="modal-overlay">
        <div class="modal-content">
            <button id="modal-close-button-qv" class="modal-close" title="إغلاق">&times;</button>
            <div class="modal-body">
                <div class="modal-image"> <img id="modal-product-image" src="" alt="صورة المنتج" loading="lazy"> </div>
                <div class="modal-details">
                    <h2 id="modal-product-title">اسم المنتج</h2>
                     <div class="info-item"> <i class="fas fa-ruler-combined"></i> <span class="label">المقاس:</span> <span class="value" id="modal-product-size"></span> </div>
                     <div class="info-item"> <i class="fas fa-tag"></i> <span class="label">السعر:</span> <span class="value" id="modal-product-price"></span>&nbsp;<span class="currency">د.ع</span> </div>
                     <p class="description" id="modal-product-description">وصف المنتج...</p>
                     <button id="proceed-button" class="details-button" style="width: 100%; margin-top: 20px; transform: translateZ(0); font-size: 1rem; background: var(--primary-gold); color: var(--card-bg);"> <i class="fas fa-arrow-circle-left"></i> إكمال الطلب (بيانات التوصيل) </button>
                </div>
            </div>
        </div>
    </div>

    <div id="order-form-modal" class="modal-overlay">
        <div class="modal-content">
            <button id="modal-close-button-order" class="modal-close" title="إغلاق">&times;</button>
            <div class="modal-header"> <i class="fas fa-truck-fast"></i> <h2>تأكيد الطلب وبيانات التوصيل</h2> <p>خطوتك الأخيرة لتأكيد الطلب - الدفع عند الاستلام</p> </div>
            <div class="order-summary">
                 <h4><i class="fas fa-box-open"></i> المنتج المطلوب</h4> <p id="order-summary-title">اسم المنتج</p>
                 <p> <i class="fas fa-ruler-combined" style="color: var(--grey-text)"></i> المقاس: <span id="order-summary-size"></span> | <i class="fas fa-tag" style="color: var(--grey-text)"></i> السعر: <span id="order-summary-price"></span> <span class="currency">د.ع</span> </p>
                 <input type="hidden" id="order-form-product-id"> <input type="hidden" id="order-form-product-title"> <input type="hidden" id="order-form-product-size"> <input type="hidden" id="order-form-product-price">
            </div>
            <form id="order-form">
                 <div id="form-error-message"></div>
                 <div> <label for="customer-name"><i class="fas fa-user"></i> الاسم الكامل:</label> <input type="text" id="customer-name" name="customerName" required placeholder="الرجاء إدخال الاسم الثلاثي هنا..."> </div>
                 <div> <label for="customer-phone"><i class="fas fa-phone"></i> رقم الهاتف (مفعل واتساب):</label> <input type="tel" id="customer-phone" name="customerPhone" required pattern="^(07[5789][0-9]{8})$" placeholder="مثال: 07712345678"> </div>
                 <div> <label for="customer-address"><i class="fas fa-map-marker-alt"></i> العنوان الكامل:</label> <textarea id="customer-address" name="customerAddress" rows="3" required placeholder="الرجاء ذكر: المحافظة - المدينة - المنطقة/الحي - أقرب نقطة دالة معروفة..."></textarea> </div>
                 <button type="submit" id="modal-whatsapp-button-final" class="modal-whatsapp-button-final"> <i class="fab fa-whatsapp"></i> تأكيد وإرسال الطلب عبر واتساب </button>
             </form>
        </div>
    </div>

    <nav class="bottom-nav">
         <ul>
            <li><a href="#category-header" data-category="all" class="nav-link-mobile active"><i class="fas fa-store"></i><span class="nav-text">الكل</span></a></li>
            <li><a href="#category-header" data-category="trousers" class="nav-link-mobile"><i class="fas fa-user-secret"></i><span class="nav-text">بناطيل</span></a></li> <li><a href="#category-header" data-category="maternity" class="nav-link-mobile"><i class="fas fa-person-pregnant"></i><span class="nav-text">حوامل</span></a></li>
            <li><a href="#category-header" data-category="tops" class="nav-link-mobile"><i class="fas fa-tshirt"></i><span class="nav-text">توبات</span></a></li>
        </ul>
    </nav>


    <footer>
        <p>&copy; <span id="year"></span> Master Quality. عنوانك الأول للأناقة الفاخرة.</p>
        <p>للتواصل و الطلب: <a href="https://wa.me/9647711359997" target="_blank" rel="noopener noreferrer"> <i class="fab fa-whatsapp"></i> تواصل معنا عبر واتساب</a></p>
    </footer>

    <script>
        // --- Product Data (Same as before) ---
        const products = [
            // --- Trousers/Jeggings ---
            { id: 1, title: "بنطلون جيجنز Master Quality أزرق مريح", image: "1.png", price: "12,000", size: "S (كمر 36)", base_size: "S", category: "trousers", availability: "in stock", description: "جيجنز مريح وعملي بلون أزرق جذاب، مثالي للارتداء اليومي.", is_new: false },
            { id: 4, title: "بنطلون جيجنز Master Quality أزرق عملي", image: "4.png", price: "12,000", size: "M (كمر 40)", base_size: "M", category: "trousers", availability: "in stock", description: "جيجنز بقصة عملية ومريحة للاستخدام اليومي.", is_new: false },
            { id: 5, title: "بنطلون Master Quality مطبع بألوان زاهية", image: "5.png", price: "14,000", size: "L (كمر 42)", base_size: "L", category: "trousers", availability: "in stock", description: "بنطلون قماش خفيف بنقشة بيزلي زاهية ومميزة.", is_new: true }, // Marked as new
            { id: 7, title: "بنطلون Master Quality خصر عالي جملي", image: "7.png", price: "15,000", size: "XXL (كمر 48)", base_size: "XXL", category: "trousers", availability: "in stock", description: "بنطلون أنيق بلون جملي دافئ وخصر عالي مع أزرار زينة.", is_new: false },
            { id: 8, title: "بنطلون Master Quality مقلم أرجل واسعة رمادي", image: "8.png", price: "14,000", size: "M (كمر 38)", base_size: "M", category: "trousers", availability: "in stock", description: "بنطلون عصري مقلم بقصة أرجل واسعة ومريحة.", is_new: false },
            { id: 9, title: "بنطلون Master Quality أسود بحزام وكسرات", image: "9.png", price: "14,000", size: "M (كمر 38)", base_size: "M", category: "trousers", availability: "in stock", description: "بنطلون أسود كلاسيكي مع حزام أنيق وكسرات أمامية لإطلالة رسمية.", is_new: false },
            { id: 10, title: "بنطلون Master Quality بيج أرجل واسعة", image: "10.png", price: "14,000", size: "M (كمر 38)", base_size: "M", category: "trousers", availability: "in stock", description: "بنطلون بيج فاتح بقصة أرجل واسعة وخامة مريحة للصيف.", is_new: false },
            { id: 11, title: "بنطلون Master Quality أصفر خردلي برباط خصر", image: "11.png", price: "12,000", size: "L (كمر 42)", base_size: "L", category: "trousers", availability: "in stock", description: "بنطلون كاجوال مريح بلون أصفر خردلي جذاب وخصر مطاطي مع رباط.", is_new: false },
            { id: 12, title: "بنطلون Master Quality أبيض قصة مرتبة", image: "12.png", price: "14,000", size: "S (كمر 34)", base_size: "S", category: "trousers", availability: "in stock", description: "بنطلون أبيض أساسي بقصة كلاسيكية مرتبة لمختلف المناسبات.", is_new: true }, // Marked as new
            { id: 13, title: "بنطلون Master Quality دانتيل أبيض", image: "13.png", price: "18,000", size: "L (كمر 42)", base_size: "L", category: "trousers", availability: "in stock", description: "بنطلون أنيق من الدانتيل الأبيض الفاخر لإطلالة مميزة وجذابة.", is_new: false },
            { id: 14, title: "بنطلون Master Quality ليجنز زيتي مطبع", image: "14.png", price: "14,000", size: "M (كمر 37)", base_size: "M", category: "trousers", availability: "in stock", description: "ليجنز مريح بلون زيتي عملي ونقشة هادئة.", is_new: false },
             // --- Maternity Wear ---
            { id: 2, title: "بنطلون جينز حوامل Master Quality أزرق فاتح", image: "2.png", price: "18,000", size: "XL (كمر 44)", base_size: "XL", category: "maternity", availability: "in stock", description: "جينز حوامل بقصة مريحة ولون فاتح مع حزام بطن قماشي عريض ومرن.", is_new: false },
            { id: 3, title: "بنطلون جينز حوامل Master Quality أزرق فاتح", image: "3.png", price: "18,000", size: "L (كمر 40)", base_size: "L", category: "maternity", availability: "in stock", description: "جينز حوامل بقصة مريحة ولون فاتح مع حزام بطن قماشي عريض ومرن.", is_new: false },
            // --- Tops ---
            { id: 15, title: "توب تانك Master Quality مضلع رمادي غامق", image: "15.png", price: "4,000", size: "XL", base_size: "XL", category: "tops", availability: "in stock", description: "توب أساسي مضلع ومريح بلون رمادي غامق للاستخدام اليومي.", is_new: false },
            { id: 16, title: "توب كروب Master Quality مضلع أخضر ليموني", image: "16.png", price: "4,000", size: "L", base_size: "L", category: "tops", availability: "in stock", description: "توب كروب عصري مضلع بلون نيون منعش وحافة مكشكشة.", is_new: true }, // Marked as new
            { id: 17, title: "توب تانك Master Quality مخطط فوشي/أبيض", image: "17.png", price: "4,000", size: "XL", base_size: "XL", category: "tops", availability: "in stock", description: "توب مخطط كلاسيكي بألوان صيفية زاهية وحواف بيضاء.", is_new: false },
            { id: 18, title: "توب تانك Master Quality مضلع أبيض", image: "18.png", price: "4,000", size: "XL", base_size: "XL", category: "tops", availability: "in stock", description: "توب أبيض أساسي مضلع لا غنى عنه في أي خزانة.", is_new: false },
            { id: 19, title: "توب تانك Master Quality أخضر زاهي", image: "19.png", price: "4,000", size: "XL", base_size: "XL", category: "tops", availability: "in stock", description: "توب أساسي مريح وعملي بلون أخضر منعش.", is_new: false },
            { id: 20, title: "توب تانك Master Quality تركوازي", image: "20.png", price: "4,000", size: "M", base_size: "M", category: "tops", availability: "in stock", description: "توب أساسي ناعم بلون تركوازي هادئ ومريح.", is_new: false },
            { id: 21, title: "توب تانك Master Quality أسود", image: "21.png", price: "4,000", size: "XS", base_size: "XS", category: "tops", availability: "in stock", description: "توب أسود أساسي عملي لكل الإطلالات برقبة واسعة قليلاً.", is_new: false },
            { id: 22, title: "كاميصول Master Quality تركوازي بحواف دانتيل", image: "22.png", price: "4,000", size: "S", base_size: "S", category: "tops", availability: "in stock", description: "كاميصول ناعم بلون تركوازي مع لمسة دانتيل أنثوية على الحافة.", is_new: false },
            { id: 23, title: "كاميصول Master Quality تركوازي بحواف دانتيل", image: "23.png", price: "4,000", size: "2XL", base_size: "2XL", category: "tops", availability: "in stock", description: "كاميصول ناعم بلون تركوازي مع لمسة دانتيل أنثوية على الحافة.", is_new: false },
            { id: 24, title: "توب تانك Master Quality رمادي فاتح ميلانج", image: "24.png", price: "4,000", size: "2XL", base_size: "2XL", category: "tops", availability: "in stock", description: "توب أساسي مريح وعملي بلون رمادي فاتح ميلانج.", is_new: false },
            { id: 25, title: "كاميصول Master Quality أخضر فاتح بحواف دانتيل", image: "25.png", price: "4,000", size: "2XL", base_size: "2XL", category: "tops", availability: "in stock", description: "كاميصول ناعم بلون أخضر باستيل ولمسة دانتيل رقيقة.", is_new: false },
            { id: 26, title: "توب كروب Master Quality أخضر فاتح بملمس مميز", image: "26.png", price: "4,000", size: "XS", base_size: "XS", category: "tops", availability: "in stock", description: "توب كروب عصري بملمس مجعد (سموكيد) ورقبة V.", is_new: true }, // Marked as new
            { id: 27, title: "توب تانك Master Quality مخطط أخضر/أبيض مضلع", image: "27.png", price: "4,000", size: "2XL", base_size: "2XL", category: "tops", availability: "in stock", description: "توب مضلع مخطط بقصة مريحة وألوان منعشة.", is_new: false },
            { id: 28, title: "كاميصول Master Quality أوف وايت/كريمي", image: "28.png", price: "4,000", size: "2XL", base_size: "2XL", category: "tops", availability: "in stock", description: "كاميصول أساسي ناعم بلون أوف وايت هادئ ومريح.", is_new: false },
            { id: 29, title: "توب كروب Master Quality خوخي/مرجاني بملمس مميز", image: "29.png", price: "4,000", size: "2XL", base_size: "2XL", category: "tops", availability: "in stock", description: "توب كروب عصري بملمس مجعد (سموكيد) ورقبة V بلون خوخي.", is_new: false },
            { id: 30, title: "توب/فيست Master Quality محبوك بنقشة مموجة", image: "30.png", price: "4,000", size: "L", base_size: "L", category: "tops", availability: "in stock", description: "فيست محبوك بنقشة مموجة جريئة وألوان زاهية (أزرق وأصفر).", is_new: true }, // Marked as new
            { id: 31, title: "توب تانك Master Quality أخضر ليموني نيون", image: "31.png", price: "4,000", size: "L", base_size: "L", category: "tops", availability: "in stock", description: "توب رياضي أو كاجوال بلون نيون منعش وقصة مريحة.", is_new: false },
            { id: 32, title: "توب كروب Master Quality أخضر بقصة غير متماثلة", image: "32.png", price: "4,000", size: "XL", base_size: "XL", category: "tops", availability: "in stock", description: "توب كروب عصري بقصة كتف غير متماثلة وجريئة.", is_new: false },
            { id: 33, title: "توب تانك Master Quality مخطط كحلي/أبيض", image: "33.png", price: "4,000", size: "XL", base_size: "XL", category: "tops", availability: "in stock", description: "توب مخطط كلاسيكي بستايل بحري أنيق (كحلي وأبيض).", is_new: false },
            { id: 34, title: "توب كروب Master Quality مضلع بيج", image: "34.png", price: "4,000", size: "XS", base_size: "XS", category: "tops", availability: "in stock", description: "توب كروب أساسي مضلع بلون بيج محايد وعصري.", is_new: false },
            { id: 35, title: "كاميصول Master Quality فوشي بحواف دانتيل", image: "35.png", price: "4,000", size: "2XL", base_size: "2XL", category: "tops", availability: "in stock", description: "كاميصول أنثوي بلون فوشي جذاب ولمسة دانتيل رقيقة.", is_new: false },
            { id: 37, title: "توب كروب Master Quality مخطط أخضر فاتح/أبيض مضلع", image: "37.png", price: "4,000", size: "S", base_size: "S", category: "tops", availability: "in stock", description: "توب كروب مضلع ومخطط بألوان هادئة (أخضر فاتح وأبيض).", is_new: false },
            { id: 38, title: "توب كروب Master Quality أسود بكشكشة", image: "38.png", price: "4,000", size: "S", base_size: "S", category: "tops", availability: "in stock", description: "توب كروب أسود أنيق بتصميم كشكشة أمامي للمناسبات.", is_new: true } // Marked as new
        ];

        // --- DOM Elements ---
        const productGrid = document.getElementById('product-grid-main');
        const categoryHeader = document.getElementById('category-header');
        const categoryTitleMain = document.getElementById('category-title-main');
        const allCards = [];
        const noResultsDiv = document.getElementById('no-results');
        // Desktop Controls
        const desktopSearchInput = document.getElementById('search-input');
        const desktopSizeSelect = document.getElementById('size-select');
        const desktopNavLinks = document.querySelectorAll('nav.desktop-nav ul li a.nav-link');
        // Mobile Controls
        const mobileSearchInput = document.getElementById('search-input-mobile');
        const mobileSizeSelect = document.getElementById('size-select-mobile');
        const mobileNavLinks = document.querySelectorAll('.bottom-nav ul li a.nav-link-mobile');
        const mobileSearchOverlay = document.getElementById('mobile-search-overlay');
        const mobileFilterOverlay = document.getElementById('mobile-filter-overlay');
        const mobileSearchBtn = document.getElementById('mobile-search-btn');
        const mobileFilterBtn = document.getElementById('mobile-filter-btn');
        const closeSearchOverlayBtn = document.getElementById('close-search-overlay');
        const closeFilterOverlayBtn = document.getElementById('close-filter-overlay');
        const applyMobileFiltersBtn = document.getElementById('apply-mobile-filters');
        // Modals & Content
        const quickViewModalOverlay = document.getElementById('quick-view-modal');
        const quickViewModalCloseButton = document.getElementById('modal-close-button-qv');
        const orderFormModalOverlay = document.getElementById('order-form-modal');
        const orderFormModalCloseButton = document.getElementById('modal-close-button-order');
        const modalImage = document.getElementById('modal-product-image');
        const modalTitle = document.getElementById('modal-product-title');
        const modalSize = document.getElementById('modal-product-size');
        const modalPrice = document.getElementById('modal-product-price');
        const modalDescription = document.getElementById('modal-product-description');
        const proceedButton = document.getElementById('proceed-button');
        const orderForm = document.getElementById('order-form');
        const formErrorMessage = document.getElementById('form-error-message');
        const orderSummaryTitle = document.getElementById('order-summary-title');
        const orderSummarySize = document.getElementById('order-summary-size');
        const orderSummaryPrice = document.getElementById('order-summary-price');
        const orderFormProductId = document.getElementById('order-form-product-id');
        const orderFormProductTitle = document.getElementById('order-form-product-title');
        const orderFormProductSize = document.getElementById('order-form-product-size');
        const orderFormProductPrice = document.getElementById('order-form-product-price');

        const whatsappNumber = '9647711359997';
        let currentProductIdForOrder = null;
        let activeCategory = 'all';

        // --- Create Card Function ---
        function createProductCard(product, index) {
            const card = document.createElement('div');
            card.className = 'product-card';
            // Animation delay set when filtering/displaying
            card.dataset.title = product.title.toLowerCase();
            card.dataset.category = product.category;
            card.dataset.base_size = product.base_size;
            card.dataset.id = product.id;
            card.style.display = 'none'; // Initially hidden
            card.onclick = () => openQuickView(product.id); // Card is clickable

            const badgesContainer = document.createElement('div'); badgesContainer.className = 'badges';
            if (product.availability === 'in stock') { const b = document.createElement('span'); b.className = 'badge available'; b.innerHTML = '<i class="fas fa-check-circle"></i> متوفر'; badgesContainer.appendChild(b); }
            if (product.is_new) { const b = document.createElement('span'); b.className = 'badge new-arrival'; b.innerHTML = '<i class="fas fa-star"></i> جديد'; badgesContainer.appendChild(b); }
            card.appendChild(badgesContainer);

            const imageContainer = document.createElement('div'); imageContainer.className = 'product-image-container';
            const img = document.createElement('img'); img.src = product.image; img.alt = product.title; img.loading = 'lazy'; imageContainer.appendChild(img);

            const infoContainer = document.createElement('div'); infoContainer.className = 'product-info';
            const title = document.createElement('h3'); title.textContent = product.title;
            const price = document.createElement('p'); price.className = 'price-card'; price.innerHTML = `<i class="fas fa-tag"></i> ${product.price} <span class="currency">د.ع</span>`;
             // No button inside card anymore

            infoContainer.appendChild(title); infoContainer.appendChild(price);
            card.appendChild(imageContainer); card.appendChild(infoContainer);
            return card;
        }

        // --- Open/Close Modals (Same logic) ---
         function openQuickView(productId) { /* ... same ... */
             const product = products.find(p => p.id === productId); if (!product) return;
             currentProductIdForOrder = productId; modalImage.src = product.image; modalImage.alt = product.title;
             modalTitle.textContent = product.title; modalSize.textContent = product.size; modalPrice.textContent = product.price;
             modalDescription.textContent = product.description || "تصميم مميز وعصري من أجود الخامات المتوفرة.";
             quickViewModalOverlay.classList.add('active');
         }
        function closeQuickView() { quickViewModalOverlay.classList.remove('active'); }
        function openOrderModal() { /* ... same ... */
             if (!currentProductIdForOrder) return; const product = products.find(p => p.id === currentProductIdForOrder); if (!product) return;
             closeQuickView(); orderSummaryTitle.textContent = product.title; orderSummarySize.textContent = product.size;
             orderSummaryPrice.textContent = product.price; orderFormProductId.value = product.id; orderFormProductTitle.value = product.title;
             orderFormProductSize.value = product.size; orderFormProductPrice.value = product.price; orderForm.reset();
             formErrorMessage.style.display = 'none'; orderFormModalOverlay.classList.add('active');
         }
         function closeOrderModal() { orderFormModalOverlay.classList.remove('active'); currentProductIdForOrder = null; }


        // --- Filter and Display Function (Refined Animation Handling) ---
        function filterAndDisplayProducts(trigger = 'load') {
             const isMobile = window.innerWidth <= 768;
             const searchTerm = (isMobile ? mobileSearchInput.value : desktopSearchInput.value).toLowerCase().trim();
             const selectedSize = (isMobile ? mobileSizeSelect.value : desktopSizeSelect.value);
             let visibleCount = 0;
             let visibleIndex = 0;

             const activeLink = document.querySelector('.nav-link.active') || document.querySelector('.nav-link-mobile.active');
             categoryTitleMain.textContent = activeLink ? activeLink.textContent.replace(/<[^>]*>/g, '').trim() : "جميع المنتجات";
             categoryHeader.classList.add('active');

             // This approach might be slightly less smooth than class toggling but ensures
             // correct delay calculation when filters change rapidly.
             productGrid.style.opacity = 0; // Hide grid for redraw

             // Clear grid before re-populating (or just hide/show existing)
             // For simplicity, let's stick to hide/show existing `allCards` array
             allCards.forEach(card => {
                 const title = card.dataset.title;
                 const category = card.dataset.category;
                 const baseSize = card.dataset.base_size;
                 const categoryMatch = activeCategory === 'all' || category === activeCategory;
                 const searchMatch = !searchTerm || title.includes(searchTerm);
                 const sizeMatch = selectedSize === 'all' || baseSize === selectedSize;
                 const isVisible = categoryMatch && searchMatch && sizeMatch;

                 if (isVisible) {
                     card.style.display = 'flex';
                     // Apply animation delay based on visible order
                     card.style.animation = 'none'; // Reset animation state
                     void card.offsetWidth; // Trigger reflow
                     card.style.animation = `fadeInUpCard 0.8s cubic-bezier(0.165, 0.84, 0.44, 1) forwards ${visibleIndex * 0.07}s`;
                     visibleCount++;
                     visibleIndex++;
                 } else {
                     card.style.display = 'none';
                     card.style.animation = 'none';
                 }
             });

             productGrid.style.opacity = 1; // Fade grid back in (could use CSS transition)
             noResultsDiv.style.display = visibleCount === 0 ? 'block' : 'none';
         }


        // --- Handle Final Order Form Submission (No change needed) ---
        orderForm.addEventListener('submit', function(event) { /* ... same comprehensive message logic ... */
             event.preventDefault();
             const customerName = document.getElementById('customer-name').value.trim(); const customerPhone = document.getElementById('customer-phone').value.trim(); const customerAddress = document.getElementById('customer-address').value.trim();
             if (!customerName || !customerPhone || !customerAddress) { formErrorMessage.textContent = 'يرجى ملء جميع حقول معلومات التوصيل.'; formErrorMessage.style.display = 'block'; return; }
             const phonePattern = /^(07[5789][0-9]{8})$/; if (!phonePattern.test(customerPhone)) { formErrorMessage.textContent = 'يرجى إدخال رقم هاتف عراقي صحيح (مثال: 077xxxxxxxx).'; formErrorMessage.style.display = 'block'; return; }
             formErrorMessage.style.display = 'none';
             const productId = orderFormProductId.value; const productTitle = orderFormProductTitle.value; const productSize = orderFormProductSize.value; const productPrice = orderFormProductPrice.value;
             const message = `\n=========================\n      🌟 طلب جديـد 🌟\n=========================\n\nالمنتج المطلوب:\n* ${productTitle}\n* الرقم التعريفي: ${productId}\n* المقاس: ${productSize}\n* السعر: ${productPrice} د.ع\n\n=========================\n     👤 بيانات الزبـون 👤\n=========================\n\n* الاسم: ${customerName}\n* رقم الهاتف: ${customerPhone}\n* العنوان: ${customerAddress}\n\n=========================\n   (الدفع عند الاستـلام)\n    ✨ شكراً لطلبكـم ✨\n=========================\n            `;
             const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message.trim())}`; window.open(whatsappUrl, '_blank'); closeOrderModal();
         });


        // --- Populate Initial Grid ---
        products.forEach((product, index) => {
            const cardElement = createProductCard(product, index);
            productGrid.appendChild(cardElement);
            allCards.push(cardElement);
        });

        // --- Navigation & Filter Logic ---
         function setActiveCategory(category, clickedLinkElement = null) {
             activeCategory = category;
             desktopNavLinks.forEach(link => link.classList.remove('active'));
             mobileNavLinks.forEach(link => link.classList.remove('active'));
             const desktopLink = document.querySelector(`.nav-link[data-category="${category}"]`);
             const mobileLink = document.querySelector(`.nav-link-mobile[data-category="${category}"]`);
             if(desktopLink) desktopLink.classList.add('active');
             if(mobileLink) mobileLink.classList.add('active');

             if(clickedLinkElement) {
                 desktopSizeSelect.value = 'all'; desktopSearchInput.value = '';
                 mobileSizeSelect.value = 'all'; mobileSearchInput.value = '';
             }
             filterAndDisplayProducts('categoryChange');
             const targetElement = document.getElementById('category-header');
             if (targetElement) {
                 const headerHeight = document.querySelector('header').offsetHeight + 10; // Add some buffer
                 const elementPosition = targetElement.getBoundingClientRect().top + window.pageYOffset;
                 const offsetPosition = elementPosition - headerHeight;
                 window.scrollTo({ top: offsetPosition, behavior: 'smooth' });
             }
         }
         desktopNavLinks.forEach(link => { link.addEventListener('click', (e) => { e.preventDefault(); setActiveCategory(e.target.dataset.category, e.target); }); });
         mobileNavLinks.forEach(link => { link.addEventListener('click', (e) => { e.preventDefault(); const targetLink = e.target.closest('a'); if (!targetLink) return; setActiveCategory(targetLink.dataset.category, targetLink); }); });
         function showAllProducts() { setActiveCategory('all'); }


        // --- Event Listeners ---
        desktopSearchInput.addEventListener('input', () => filterAndDisplayProducts('search'));
        desktopSizeSelect.addEventListener('change', () => filterAndDisplayProducts('size'));
        mobileSearchInput.addEventListener('input', () => filterAndDisplayProducts('search'));
        mobileSizeSelect.addEventListener('change', () => filterAndDisplayProducts('size'));
        mobileSearchBtn.addEventListener('click', () => mobileSearchOverlay.classList.add('active'));
        closeSearchOverlayBtn.addEventListener('click', () => mobileSearchOverlay.classList.remove('active'));
        mobileFilterBtn.addEventListener('click', () => mobileFilterOverlay.classList.add('active'));
        closeFilterOverlayBtn.addEventListener('click', () => mobileFilterOverlay.classList.remove('active'));
        applyMobileFiltersBtn.addEventListener('click', () => { mobileFilterOverlay.classList.remove('active'); filterAndDisplayProducts('size'); });
        mobileSearchOverlay.addEventListener('click', (e) => { if(e.target === mobileSearchOverlay) mobileSearchOverlay.classList.remove('active'); });
        mobileFilterOverlay.addEventListener('click', (e) => { if(e.target === mobileFilterOverlay) mobileFilterOverlay.classList.remove('active'); });
        quickViewModalCloseButton.addEventListener('click', closeQuickView);
        quickViewModalOverlay.addEventListener('click', (event) => { if (event.target === quickViewModalOverlay) closeQuickView(); });
        proceedButton.addEventListener('click', openOrderModal);
        orderFormModalCloseButton.addEventListener('click', closeOrderModal);
        orderFormModalOverlay.addEventListener('click', (event) => { if (event.target === orderFormModalOverlay) closeOrderModal(); });

        // --- Footer Year ---
        document.getElementById('year').textContent = new Date().getFullYear();

        // --- Initial Display ---
        document.addEventListener('DOMContentLoaded', () => { setActiveCategory('all'); });

    </script>

</body>
</html>
